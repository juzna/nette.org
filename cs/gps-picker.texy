#### GpsPicker

Formulářový prvek pro výběr souřadnic v mapě. .[perex]

|* Composer | "vojtech-dobes/nette-forms-gpspicker":http://packagist.org/packages/vojtech-dobes/nette-forms-gpspicker
|* Github | https://github.com/vojtech-dobes/nette-forms-gpspicker
|* Fórum | http://forum.nette.org/cs/11922-gpspicker-formularovy-prvek-pro-vyber-gps
|* Autor | Vojtěch Dobeš
|* Licence | New BSD

### Instalace

1. Získáme zdrojový kód z Githubu nebo přes Composer.
2. Obsah složky `src` přidáme mezi knihovny.
3. V `bootstrap.php` provedeme registraci extenze `VojtechDobes\NetteForms\GpsPickerExtension` do `$configurator->onCompile[]`.
4. Do `app/@layout.latte` přilinkujeme jQuery, Google Maps API v3 (with Places) a `client/nette.gpsPicker.js`.

/--js
{
	"require": {
		"vojtech-dobes/nette-forms-gpspicker": "1.0.x"
	}
}
\--

/--php
$configurator->onCompile[] = function ($configurator, $compiler) {
	$compiler->addExtension('gpspicker', new VojtechDobes\NetteForms\GpsPickerExtension);
};
\--

/--html
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
	<script type="text/javascript" src="{$basePath}/libs/nette.gpsPicker.js"></script>
</body>
\--

### Použití

/--php
$form->addGpsPicker('coords', 'Coordinates:');
\--

Můžeme přidat nastavení:

/--php
$form->addGpsPicker('coords', 'Coordinates:', array(
	'type' => VojtechDobes\NetteForms\GpsPicker::TYPE_SATELLITE,
	'zoom' => 1,
	'size' => array(
		'x' => 411,
		'y' => 376,
	),
));
\--

Pokud bychom chtěli formulář renderovat manuálně, můžeme vynechat popisek:

/--php
$form->addGpsPicker('coords', array(
	'type' => ...
	...
));
\--

Vrácená hodnota prvku je instancí `GpsPoint` s proměnnými `lat` a `lng`. `GpsPoint` dědí od [api:Nette\Object].

/--php
$lat = $form->values->coords->lat;
$lng = $form->values->coords->lng;
\--

## Validace

/--php
use VojtechDobes\NetteForms\GpsPicker as Gps;
\--

Prvek podporuje následující validační pravidla:

/--php
$form->addGpsPicker('coords')
    ->addRule(Gps::MIN_LAT, 'Minimální zeměpisná šířka musí být %f.', 20)
    ->addRule(Gps::MIN_LNG, 'Minimální zeměpisná výška musí být %f.', 40)
    ->addRule(Gps::MAX_LAT, 'Maximální zeměpisná šířka musí být %f.', 20)
    ->addRule(Gps::MAX_LNG, 'Maximální zeměpisná výška musí být %f.', 40)
    ->addRule(Gps::MIN_DISTANCE_FROM, 'Minimální vzdálenost od Prahy musí být %d metrů.', array(15000, array(
        'lat' => 50.083,
        'lng' => 14.423,
    )));
    ->addRule(Gps::MAX_DISTANCE_FROM, 'Maximální vzdálenost od Prahy musí být %d metrů.', array(100000, array(
        'lat' => 50.083,
        'lng' => 14.423,
    )));
\--

První čtyři pravidla jsou validována i Javascriptem.

## Manuální renderování

Pokud má uživatel vypnutý Javascript nebo je offline, doplněk mu nabídne několik formulářových polí, takže může souřadnice vyplnit ručně. Tato jednotlivá pole lze jednoduše renderovat manuálně s pomocí zvláštního párového makra `{gpspicker}`.

/--html
{form formName}
    ...

    {gpspicker coords}
        {label lat}Latitude:{/label} {input lat}
        {label lng}Longitude:{/label} {input lng}
    {/gpspicker}
{/form}
\--

## Vyhledávání podle adresy

Ve výchozím stavu je GpsPicker vybaven políčkem pro nastavení lokace dle adresy, fungující na bázi Google Maps Places Autocomplete.

Políčko je stejně jako ostatní prvky možné vykreslovat ručně, a to pomocí klíče `search`:

/--html
{gpspicker coords}
    {label search /} {input search}
{/gpspicker}
\--

Vyhledávání lze vypínat/zapínat párem metod `enableSearch`/`disableSearch`:

/--php
$form->addGpsPicker('coords', 'Coordinates:')
    ->disableSearch();
\--

Nebo v konstruktoru:

/--php
$form->addGpsPicker('coords', 'Coordinates:', array(
    'search' => FALSE,
));
\--

{{extras}}

{{author: vojtech.dobes|3328}}
